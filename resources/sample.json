{
    "transforms": [
      {
        "ttype": "DirectMap",
        "rule": "Quantity",
        "dest": "Q1"
      },
      {
        "ttype": "DirectMap",
        "rule": "UnitPrice",
        "dest": "UP"
      },
      {
        "ttype": "DefaultMap",
        "rule": "USD",
        "dest": "Currency"
      },
      {
        "ttype": "IfElse",
        "rule": "case when Quantity = 6 then 9 else '' end",
        "dest": "Q1to9"
      },
      {
        "ttype": "Concat",
        "rule": "(stockCode, '*', Currency, '$')",
        "dest": "CurStock"
      },
      {
        "ttype": "Concat",
        "rule": "(stockCode, '_P')",
        "dest": "PstockCode"
      },
      {
        "ttype": "Expression",
        "rule": "case when Q1 = 6 then unitPrice else 0 end",
        "dest": "UPQ1"
      },
      {
        "rule": "case when Q1 = 6 then unitPrice else 0 end",
        "dest": "UPQ2"
      },
      {
        "ttype": "Split",
        "rule": "Q1 = 6",
        "dest": "Q1to92Split"
      }

    ],
    "split": [{
      "name" : "Q1to92Split",
      "dest_row_trans": [
        {
          "rule": "UPQ3 * Q1",
          "dest": "Q1"
        },
        {
          "rule": "Q1to92 / 2",
          "dest": "Q1to92"
        }
      ],
      "source_row_trans": [
        {
          "rule": "Q1 * 5",
          "dest": "Q1"
        },
        {
          "rule": "Q1to92 / 2",
          "dest": "Q1to92"
        }
      ]
    }],
    "select": "UPQ1 as UPQ3, UPQ2, PstockCode, Q1, Q1to9 as Q1to92",
    "struct": [
      {
        "name": "invoiceno",
        "datatype": "LongType",
        "nullable": true
      },
      {
        "name": "stockCode",
        "datatype": "StringType",
        "nullable": true
      },
      {
        "name": "description",
        "datatype": "StringType",
        "nullable": true
      },
      {
        "name": "quantity",
        "datatype": "IntegerType",
        "nullable": true
      },
      {
        "name": "invoiceDate",
        "datatype": "DateType",
        "nullable": true
      },
      {
        "name": "unitPrice",
        "datatype": "DoubleType",
        "nullable": true
      },
      {
        "name": "customer_id",
        "datatype": "DoubleType",
        "nullable": true
      },
      {
        "name": "country",
        "datatype": "StringType",
        "nullable": true
      }
    ]
}
